obtv-admin@mov-orc-dev:/opt/color-routing-orchestrator$ sudo journalctl -u color-routing-orchestrator --since "1 minute ago" | grep -i error
Jan 30 22:43:16 mov-orc-dev npx[17959]: [python] INFO:     10.100.4.150:0 - "POST /api/sites/Tustin/heartbeat HTTP/1.1" 500 Internal Server Error
Jan 30 22:43:16 mov-orc-dev npx[17959]: [python] ERROR:    Exception in ASGI application
Jan 30 22:43:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 186, in __call__
Jan 30 22:43:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 164, in __call__
Jan 30 22:43:16 mov-orc-dev npx[17959]: asyncpg.exceptions.UndefinedFunctionError: function lower(site) does not exist
Jan 30 22:43:46 mov-orc-dev npx[17959]: [python] INFO:     10.100.4.150:0 - "POST /api/sites/Tustin/heartbeat HTTP/1.1" 500 Internal Server Error
Jan 30 22:43:46 mov-orc-dev npx[17959]: [python] ERROR:    Exception in ASGI application
Jan 30 22:43:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 186, in __call__
Jan 30 22:43:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 164, in __call__
Jan 30 22:43:46 mov-orc-dev npx[17959]: asyncpg.exceptions.UndefinedFunctionError: function lower(site) does not exist
obtv-admin@mov-orc-dev:/opt/color-routing-orchestrator$ sudo journalctl -u color-routing-orchestrator --since "2 minutes ago" --no-pager
Jan 30 22:42:37 mov-orc-dev npx[17959]: [python] INFO:     172.31.204.121:0 - "GET /api/bootstrap HTTP/1.1" 200 OK
Jan 30 22:42:37 mov-orc-dev npx[17959]: 10:42:37 PM [server] GET /api/bootstrap 200 in 8ms
Jan 30 22:42:37 mov-orc-dev npx[17959]: [python] INFO:     172.31.204.121:0 - "GET /api/auth/me HTTP/1.1" 200 OK
Jan 30 22:42:37 mov-orc-dev npx[17959]: 10:42:37 PM [server] GET /api/auth/me 200 in 15ms
Jan 30 22:42:37 mov-orc-dev npx[17959]: [python] INFO:     172.31.204.121:0 - "GET /api/sites HTTP/1.1" 200 OK
Jan 30 22:42:37 mov-orc-dev npx[17959]: 10:42:37 PM [server] GET /api/sites 200 in 11ms
Jan 30 22:42:39 mov-orc-dev npx[17959]: [python] INFO:     172.31.204.121:0 - "DELETE /api/sites/4a263a5b-293a-4311-b4d2-2bd46597b5ab HTTP/1.1" 200 OK
Jan 30 22:42:39 mov-orc-dev npx[17959]: 10:42:39 PM [server] DELETE /api/sites/4a263a5b-293a-4311-b4d2-2bd46597b5ab 200 in 6ms
Jan 30 22:42:39 mov-orc-dev npx[17959]: [python] INFO:     172.31.204.121:0 - "GET /api/sites HTTP/1.1" 200 OK
Jan 30 22:42:39 mov-orc-dev npx[17959]: 10:42:39 PM [server] GET /api/sites 200 in 4ms
Jan 30 22:42:40 mov-orc-dev npx[17959]: [python] INFO:     172.31.204.121:0 - "GET /api/bootstrap HTTP/1.1" 200 OK
Jan 30 22:42:40 mov-orc-dev npx[17959]: 10:42:40 PM [server] GET /api/bootstrap 200 in 5ms
Jan 30 22:42:40 mov-orc-dev npx[17959]: [python] INFO:     172.31.204.121:0 - "GET /api/auth/me HTTP/1.1" 200 OK
Jan 30 22:42:40 mov-orc-dev npx[17959]: 10:42:40 PM [server] GET /api/auth/me 200 in 5ms
Jan 30 22:42:40 mov-orc-dev npx[17959]: [python] INFO:     172.31.204.121:0 - "GET /api/sites HTTP/1.1" 200 OK
Jan 30 22:42:40 mov-orc-dev npx[17959]: 10:42:40 PM [server] GET /api/sites 200 in 6ms
Jan 30 22:42:41 mov-orc-dev npx[17959]: [python] INFO:     172.31.204.121:0 - "GET /api/bootstrap HTTP/1.1" 200 OK
Jan 30 22:42:41 mov-orc-dev npx[17959]: 10:42:41 PM [server] GET /api/bootstrap 200 in 6ms
Jan 30 22:42:41 mov-orc-dev npx[17959]: [python] INFO:     172.31.204.121:0 - "GET /api/auth/me HTTP/1.1" 200 OK
Jan 30 22:42:41 mov-orc-dev npx[17959]: 10:42:41 PM [server] GET /api/auth/me 200 in 4ms
Jan 30 22:42:41 mov-orc-dev npx[17959]: [python] INFO:     172.31.204.121:0 - "GET /api/sites HTTP/1.1" 200 OK
Jan 30 22:42:41 mov-orc-dev npx[17959]: 10:42:41 PM [server] GET /api/sites 200 in 5ms
Jan 30 22:42:46 mov-orc-dev npx[17959]: [python] INFO:     10.100.4.150:0 - "POST /api/sites/Tustin/heartbeat HTTP/1.1" 500 Internal Server Error
Jan 30 22:42:46 mov-orc-dev npx[17959]: 10:42:46 PM [server] POST /api/sites/Tustin/heartbeat 500 in 4ms
Jan 30 22:42:46 mov-orc-dev npx[17959]: [python] ERROR:    Exception in ASGI application
Jan 30 22:42:46 mov-orc-dev npx[17959]: Traceback (most recent call last):
Jan 30 22:42:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/uvicorn/protocols/http/h11_impl.py", line 410, in run_asgi
Jan 30 22:42:46 mov-orc-dev npx[17959]:     result = await app(  # type: ignore[func-returns-value]
Jan 30 22:42:46 mov-orc-dev npx[17959]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:42:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
Jan 30 22:42:46 mov-orc-dev npx[17959]:     return await self.app(scope, receive, send)
Jan 30 22:42:46 mov-orc-dev npx[17959]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:42:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/fastapi/applications.py", line 1135, in __call__
Jan 30 22:42:46 mov-orc-dev npx[17959]:     await super().__call__(scope, receive, send)
Jan 30 22:42:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/applications.py", line 107, in __call__
Jan 30 22:42:46 mov-orc-dev npx[17959]:     await self.middleware_stack(scope, receive, send)
Jan 30 22:42:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 186, in __call__
Jan 30 22:42:46 mov-orc-dev npx[17959]:     raise exc
Jan 30 22:42:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 164, in __call__
Jan 30 22:42:46 mov-orc-dev npx[17959]:     await self.app(scope, receive, _send)
Jan 30 22:42:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
Jan 30 22:42:46 mov-orc-dev npx[17959]:     await self.app(scope, receive, send)
Jan 30 22:42:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
Jan 30 22:42:46 mov-orc-dev npx[17959]:     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
Jan 30 22:42:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
Jan 30 22:42:46 mov-orc-dev npx[17959]:     raise exc
Jan 30 22:42:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
Jan 30 22:42:46 mov-orc-dev npx[17959]:     await app(scope, receive, sender)
Jan 30 22:42:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
Jan 30 22:42:46 mov-orc-dev npx[17959]:     await self.app(scope, receive, send)
Jan 30 22:42:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/routing.py", line 716, in __call__
Jan 30 22:42:46 mov-orc-dev npx[17959]:     await self.middleware_stack(scope, receive, send)
Jan 30 22:42:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/routing.py", line 736, in app
Jan 30 22:42:46 mov-orc-dev npx[17959]:     await route.handle(scope, receive, send)
Jan 30 22:42:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/routing.py", line 290, in handle
Jan 30 22:42:46 mov-orc-dev npx[17959]:     await self.app(scope, receive, send)
Jan 30 22:42:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/fastapi/routing.py", line 115, in app
Jan 30 22:42:46 mov-orc-dev npx[17959]:     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
Jan 30 22:42:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
Jan 30 22:42:46 mov-orc-dev npx[17959]:     raise exc
Jan 30 22:42:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
Jan 30 22:42:46 mov-orc-dev npx[17959]:     await app(scope, receive, sender)
Jan 30 22:42:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/fastapi/routing.py", line 101, in app
Jan 30 22:42:46 mov-orc-dev npx[17959]:     response = await f(request)
Jan 30 22:42:46 mov-orc-dev npx[17959]:                ^^^^^^^^^^^^^^^^
Jan 30 22:42:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/fastapi/routing.py", line 355, in app
Jan 30 22:42:46 mov-orc-dev npx[17959]:     raw_response = await run_endpoint_function(
Jan 30 22:42:46 mov-orc-dev npx[17959]:                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:42:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/fastapi/routing.py", line 243, in run_endpoint_function
Jan 30 22:42:46 mov-orc-dev npx[17959]:     return await dependant.call(**values)
Jan 30 22:42:46 mov-orc-dev npx[17959]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:42:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/server_python/main.py", line 530, in site_heartbeat
Jan 30 22:42:46 mov-orc-dev npx[17959]:     site = await storage.update_site_heartbeat(site_id)
Jan 30 22:42:46 mov-orc-dev npx[17959]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:42:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/server_python/storage.py", line 221, in update_site_heartbeat
Jan 30 22:42:46 mov-orc-dev npx[17959]:     row = await conn.fetchrow("SELECT * FROM sites WHERE LOWER(name) = LOWER($1)", site_id)
Jan 30 22:42:46 mov-orc-dev npx[17959]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:42:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/asyncpg/connection.py", line 752, in fetchrow
Jan 30 22:42:46 mov-orc-dev npx[17959]:     data = await self._execute(
Jan 30 22:42:46 mov-orc-dev npx[17959]:            ^^^^^^^^^^^^^^^^^^^^
Jan 30 22:42:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/asyncpg/connection.py", line 1873, in _execute
Jan 30 22:42:46 mov-orc-dev npx[17959]:     result, _ = await self.__execute(
Jan 30 22:42:46 mov-orc-dev npx[17959]:                 ^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:42:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/asyncpg/connection.py", line 1970, in __execute
Jan 30 22:42:46 mov-orc-dev npx[17959]:     result, stmt = await self._do_execute(
Jan 30 22:42:46 mov-orc-dev npx[17959]:                    ^^^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:42:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/asyncpg/connection.py", line 2013, in _do_execute
Jan 30 22:42:46 mov-orc-dev npx[17959]:     stmt = await self._get_statement(
Jan 30 22:42:46 mov-orc-dev npx[17959]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:42:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/asyncpg/connection.py", line 443, in _get_statement
Jan 30 22:42:46 mov-orc-dev npx[17959]:     statement = await self._protocol.prepare(
Jan 30 22:42:46 mov-orc-dev npx[17959]:                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:42:46 mov-orc-dev npx[17959]:   File "asyncpg/protocol/protocol.pyx", line 165, in prepare
Jan 30 22:42:46 mov-orc-dev npx[17959]: asyncpg.exceptions.UndefinedFunctionError: function lower(site) does not exist
Jan 30 22:42:46 mov-orc-dev npx[17959]: HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
Jan 30 22:42:49 mov-orc-dev npx[17959]: [python] INFO:     172.31.204.121:0 - "GET /api/bootstrap HTTP/1.1" 200 OK
Jan 30 22:42:49 mov-orc-dev npx[17959]: 10:42:49 PM [server] GET /api/bootstrap 200 in 5ms
Jan 30 22:42:49 mov-orc-dev npx[17959]: [python] INFO:     172.31.204.121:0 - "GET /api/auth/me HTTP/1.1" 200 OK
Jan 30 22:42:49 mov-orc-dev npx[17959]: 10:42:49 PM [server] GET /api/auth/me 200 in 3ms
Jan 30 22:42:49 mov-orc-dev npx[17959]: [python] INFO:     172.31.204.121:0 - "GET /api/sites HTTP/1.1" 200 OK
Jan 30 22:42:49 mov-orc-dev npx[17959]: 10:42:49 PM [server] GET /api/sites 200 in 3ms
Jan 30 22:42:49 mov-orc-dev npx[17959]: [python] INFO:     172.31.204.121:0 - "GET /api/auth/me HTTP/1.1" 200 OK
Jan 30 22:42:49 mov-orc-dev npx[17959]: 10:42:49 PM [server] GET /api/auth/me 200 in 4ms
Jan 30 22:42:49 mov-orc-dev npx[17959]: [python] INFO:     172.31.204.121:0 - "GET /api/bootstrap HTTP/1.1" 200 OK
Jan 30 22:42:49 mov-orc-dev npx[17959]: 10:42:49 PM [server] GET /api/bootstrap 200 in 3ms
Jan 30 22:42:49 mov-orc-dev npx[17959]: [python] INFO:     172.31.204.121:0 - "GET /api/sites HTTP/1.1" 200 OK
Jan 30 22:42:49 mov-orc-dev npx[17959]: 10:42:49 PM [server] GET /api/sites 200 in 3ms
Jan 30 22:43:16 mov-orc-dev npx[17959]: [python] INFO:     10.100.4.150:0 - "POST /api/sites/Tustin/heartbeat HTTP/1.1" 500 Internal Server Error
Jan 30 22:43:16 mov-orc-dev npx[17959]: 10:43:16 PM [server] POST /api/sites/Tustin/heartbeat 500 in 4ms
Jan 30 22:43:16 mov-orc-dev npx[17959]: [python] ERROR:    Exception in ASGI application
Jan 30 22:43:16 mov-orc-dev npx[17959]: Traceback (most recent call last):
Jan 30 22:43:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/uvicorn/protocols/http/h11_impl.py", line 410, in run_asgi
Jan 30 22:43:16 mov-orc-dev npx[17959]:     result = await app(  # type: ignore[func-returns-value]
Jan 30 22:43:16 mov-orc-dev npx[17959]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:43:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
Jan 30 22:43:16 mov-orc-dev npx[17959]:     return await self.app(scope, receive, send)
Jan 30 22:43:16 mov-orc-dev npx[17959]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:43:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/fastapi/applications.py", line 1135, in __call__
Jan 30 22:43:16 mov-orc-dev npx[17959]:     await super().__call__(scope, receive, send)
Jan 30 22:43:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/applications.py", line 107, in __call__
Jan 30 22:43:16 mov-orc-dev npx[17959]:     await self.middleware_stack(scope, receive, send)
Jan 30 22:43:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 186, in __call__
Jan 30 22:43:16 mov-orc-dev npx[17959]:     raise exc
Jan 30 22:43:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 164, in __call__
Jan 30 22:43:16 mov-orc-dev npx[17959]:     await self.app(scope, receive, _send)
Jan 30 22:43:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
Jan 30 22:43:16 mov-orc-dev npx[17959]:     await self.app(scope, receive, send)
Jan 30 22:43:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
Jan 30 22:43:16 mov-orc-dev npx[17959]:     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
Jan 30 22:43:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
Jan 30 22:43:16 mov-orc-dev npx[17959]:     raise exc
Jan 30 22:43:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
Jan 30 22:43:16 mov-orc-dev npx[17959]:     await app(scope, receive, sender)
Jan 30 22:43:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
Jan 30 22:43:16 mov-orc-dev npx[17959]:     await self.app(scope, receive, send)
Jan 30 22:43:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/routing.py", line 716, in __call__
Jan 30 22:43:16 mov-orc-dev npx[17959]:     await self.middleware_stack(scope, receive, send)
Jan 30 22:43:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/routing.py", line 736, in app
Jan 30 22:43:16 mov-orc-dev npx[17959]:     await route.handle(scope, receive, send)
Jan 30 22:43:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/routing.py", line 290, in handle
Jan 30 22:43:16 mov-orc-dev npx[17959]:     await self.app(scope, receive, send)
Jan 30 22:43:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/fastapi/routing.py", line 115, in app
Jan 30 22:43:16 mov-orc-dev npx[17959]:     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
Jan 30 22:43:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
Jan 30 22:43:16 mov-orc-dev npx[17959]:     raise exc
Jan 30 22:43:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
Jan 30 22:43:16 mov-orc-dev npx[17959]:     await app(scope, receive, sender)
Jan 30 22:43:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/fastapi/routing.py", line 101, in app
Jan 30 22:43:16 mov-orc-dev npx[17959]:     response = await f(request)
Jan 30 22:43:16 mov-orc-dev npx[17959]:                ^^^^^^^^^^^^^^^^
Jan 30 22:43:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/fastapi/routing.py", line 355, in app
Jan 30 22:43:16 mov-orc-dev npx[17959]:     raw_response = await run_endpoint_function(
Jan 30 22:43:16 mov-orc-dev npx[17959]:                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:43:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/fastapi/routing.py", line 243, in run_endpoint_function
Jan 30 22:43:16 mov-orc-dev npx[17959]:     return await dependant.call(**values)
Jan 30 22:43:16 mov-orc-dev npx[17959]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:43:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/server_python/main.py", line 530, in site_heartbeat
Jan 30 22:43:16 mov-orc-dev npx[17959]:     site = await storage.update_site_heartbeat(site_id)
Jan 30 22:43:16 mov-orc-dev npx[17959]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:43:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/server_python/storage.py", line 221, in update_site_heartbeat
Jan 30 22:43:16 mov-orc-dev npx[17959]:     row = await conn.fetchrow("SELECT * FROM sites WHERE LOWER(name) = LOWER($1)", site_id)
Jan 30 22:43:16 mov-orc-dev npx[17959]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:43:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/asyncpg/connection.py", line 752, in fetchrow
Jan 30 22:43:16 mov-orc-dev npx[17959]:     data = await self._execute(
Jan 30 22:43:16 mov-orc-dev npx[17959]:            ^^^^^^^^^^^^^^^^^^^^
Jan 30 22:43:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/asyncpg/connection.py", line 1873, in _execute
Jan 30 22:43:16 mov-orc-dev npx[17959]:     result, _ = await self.__execute(
Jan 30 22:43:16 mov-orc-dev npx[17959]:                 ^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:43:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/asyncpg/connection.py", line 1970, in __execute
Jan 30 22:43:16 mov-orc-dev npx[17959]:     result, stmt = await self._do_execute(
Jan 30 22:43:16 mov-orc-dev npx[17959]:                    ^^^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:43:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/asyncpg/connection.py", line 2013, in _do_execute
Jan 30 22:43:16 mov-orc-dev npx[17959]:     stmt = await self._get_statement(
Jan 30 22:43:16 mov-orc-dev npx[17959]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:43:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/asyncpg/connection.py", line 443, in _get_statement
Jan 30 22:43:16 mov-orc-dev npx[17959]:     statement = await self._protocol.prepare(
Jan 30 22:43:16 mov-orc-dev npx[17959]:                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:43:16 mov-orc-dev npx[17959]:   File "asyncpg/protocol/protocol.pyx", line 165, in prepare
Jan 30 22:43:16 mov-orc-dev npx[17959]: asyncpg.exceptions.UndefinedFunctionError: function lower(site) does not exist
Jan 30 22:43:16 mov-orc-dev npx[17959]: HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
Jan 30 22:43:34 mov-orc-dev npx[17959]: [python] INFO:     10.63.1.226:0 - "GET /api/auth/me HTTP/1.1" 401 Unauthorized
Jan 30 22:43:34 mov-orc-dev npx[17959]: 10:43:34 PM [server] GET /api/auth/me 401 in 5ms
Jan 30 22:43:34 mov-orc-dev npx[17959]: [python] INFO:     10.63.1.226:0 - "GET /api/bootstrap HTTP/1.1" 200 OK
Jan 30 22:43:34 mov-orc-dev npx[17959]: 10:43:34 PM [server] GET /api/bootstrap 200 in 5ms
Jan 30 22:43:42 mov-orc-dev npx[17959]: [python] INFO:     10.63.1.226:0 - "GET /api/auth/me HTTP/1.1" 401 Unauthorized
Jan 30 22:43:42 mov-orc-dev npx[17959]: 10:43:42 PM [server] GET /api/auth/me 401 in 4ms
Jan 30 22:43:42 mov-orc-dev npx[17959]: [python] INFO:     10.63.1.226:0 - "GET /api/bootstrap HTTP/1.1" 200 OK
Jan 30 22:43:42 mov-orc-dev npx[17959]: 10:43:42 PM [server] GET /api/bootstrap 200 in 6ms
Jan 30 22:43:46 mov-orc-dev npx[17959]: [python] INFO:     10.100.4.150:0 - "POST /api/sites/Tustin/heartbeat HTTP/1.1" 500 Internal Server Error
Jan 30 22:43:46 mov-orc-dev npx[17959]: 10:43:46 PM [server] POST /api/sites/Tustin/heartbeat 500 in 5ms
Jan 30 22:43:46 mov-orc-dev npx[17959]: [python] ERROR:    Exception in ASGI application
Jan 30 22:43:46 mov-orc-dev npx[17959]: Traceback (most recent call last):
Jan 30 22:43:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/uvicorn/protocols/http/h11_impl.py", line 410, in run_asgi
Jan 30 22:43:46 mov-orc-dev npx[17959]:     result = await app(  # type: ignore[func-returns-value]
Jan 30 22:43:46 mov-orc-dev npx[17959]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:43:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
Jan 30 22:43:46 mov-orc-dev npx[17959]:     return await self.app(scope, receive, send)
Jan 30 22:43:46 mov-orc-dev npx[17959]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:43:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/fastapi/applications.py", line 1135, in __call__
Jan 30 22:43:46 mov-orc-dev npx[17959]:     await super().__call__(scope, receive, send)
Jan 30 22:43:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/applications.py", line 107, in __call__
Jan 30 22:43:46 mov-orc-dev npx[17959]:     await self.middleware_stack(scope, receive, send)
Jan 30 22:43:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 186, in __call__
Jan 30 22:43:46 mov-orc-dev npx[17959]:     raise exc
Jan 30 22:43:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 164, in __call__
Jan 30 22:43:46 mov-orc-dev npx[17959]:     await self.app(scope, receive, _send)
Jan 30 22:43:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
Jan 30 22:43:46 mov-orc-dev npx[17959]:     await self.app(scope, receive, send)
Jan 30 22:43:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
Jan 30 22:43:46 mov-orc-dev npx[17959]:     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
Jan 30 22:43:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
Jan 30 22:43:46 mov-orc-dev npx[17959]:     raise exc
Jan 30 22:43:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
Jan 30 22:43:46 mov-orc-dev npx[17959]:     await app(scope, receive, sender)
Jan 30 22:43:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
Jan 30 22:43:46 mov-orc-dev npx[17959]:     await self.app(scope, receive, send)
Jan 30 22:43:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/routing.py", line 716, in __call__
Jan 30 22:43:46 mov-orc-dev npx[17959]:     await self.middleware_stack(scope, receive, send)
Jan 30 22:43:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/routing.py", line 736, in app
Jan 30 22:43:46 mov-orc-dev npx[17959]:     await route.handle(scope, receive, send)
Jan 30 22:43:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/routing.py", line 290, in handle
Jan 30 22:43:46 mov-orc-dev npx[17959]:     await self.app(scope, receive, send)
Jan 30 22:43:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/fastapi/routing.py", line 115, in app
Jan 30 22:43:46 mov-orc-dev npx[17959]:     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
Jan 30 22:43:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
Jan 30 22:43:46 mov-orc-dev npx[17959]:     raise exc
Jan 30 22:43:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
Jan 30 22:43:46 mov-orc-dev npx[17959]:     await app(scope, receive, sender)
Jan 30 22:43:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/fastapi/routing.py", line 101, in app
Jan 30 22:43:46 mov-orc-dev npx[17959]:     response = await f(request)
Jan 30 22:43:46 mov-orc-dev npx[17959]:                ^^^^^^^^^^^^^^^^
Jan 30 22:43:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/fastapi/routing.py", line 355, in app
Jan 30 22:43:46 mov-orc-dev npx[17959]:     raw_response = await run_endpoint_function(
Jan 30 22:43:46 mov-orc-dev npx[17959]:                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:43:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/fastapi/routing.py", line 243, in run_endpoint_function
Jan 30 22:43:46 mov-orc-dev npx[17959]:     return await dependant.call(**values)
Jan 30 22:43:46 mov-orc-dev npx[17959]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:43:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/server_python/main.py", line 530, in site_heartbeat
Jan 30 22:43:46 mov-orc-dev npx[17959]:     site = await storage.update_site_heartbeat(site_id)
Jan 30 22:43:46 mov-orc-dev npx[17959]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:43:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/server_python/storage.py", line 221, in update_site_heartbeat
Jan 30 22:43:46 mov-orc-dev npx[17959]:     row = await conn.fetchrow("SELECT * FROM sites WHERE LOWER(name) = LOWER($1)", site_id)
Jan 30 22:43:46 mov-orc-dev npx[17959]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:43:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/asyncpg/connection.py", line 752, in fetchrow
Jan 30 22:43:46 mov-orc-dev npx[17959]:     data = await self._execute(
Jan 30 22:43:46 mov-orc-dev npx[17959]:            ^^^^^^^^^^^^^^^^^^^^
Jan 30 22:43:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/asyncpg/connection.py", line 1873, in _execute
Jan 30 22:43:46 mov-orc-dev npx[17959]:     result, _ = await self.__execute(
Jan 30 22:43:46 mov-orc-dev npx[17959]:                 ^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:43:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/asyncpg/connection.py", line 1970, in __execute
Jan 30 22:43:46 mov-orc-dev npx[17959]:     result, stmt = await self._do_execute(
Jan 30 22:43:46 mov-orc-dev npx[17959]:                    ^^^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:43:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/asyncpg/connection.py", line 2013, in _do_execute
Jan 30 22:43:46 mov-orc-dev npx[17959]:     stmt = await self._get_statement(
Jan 30 22:43:46 mov-orc-dev npx[17959]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:43:46 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/asyncpg/connection.py", line 443, in _get_statement
Jan 30 22:43:46 mov-orc-dev npx[17959]:     statement = await self._protocol.prepare(
Jan 30 22:43:46 mov-orc-dev npx[17959]:                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:43:46 mov-orc-dev npx[17959]:   File "asyncpg/protocol/protocol.pyx", line 165, in prepare
Jan 30 22:43:46 mov-orc-dev npx[17959]: asyncpg.exceptions.UndefinedFunctionError: function lower(site) does not exist
Jan 30 22:43:46 mov-orc-dev npx[17959]: HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
Jan 30 22:44:16 mov-orc-dev npx[17959]: [python] INFO:     10.100.4.150:0 - "POST /api/sites/Tustin/heartbeat HTTP/1.1" 500 Internal Server Error
Jan 30 22:44:16 mov-orc-dev npx[17959]: 10:44:16 PM [server] POST /api/sites/Tustin/heartbeat 500 in 3ms
Jan 30 22:44:16 mov-orc-dev npx[17959]: [python] ERROR:    Exception in ASGI application
Jan 30 22:44:16 mov-orc-dev npx[17959]: Traceback (most recent call last):
Jan 30 22:44:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/uvicorn/protocols/http/h11_impl.py", line 410, in run_asgi
Jan 30 22:44:16 mov-orc-dev npx[17959]:     result = await app(  # type: ignore[func-returns-value]
Jan 30 22:44:16 mov-orc-dev npx[17959]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:44:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
Jan 30 22:44:16 mov-orc-dev npx[17959]:     return await self.app(scope, receive, send)
Jan 30 22:44:16 mov-orc-dev npx[17959]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:44:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/fastapi/applications.py", line 1135, in __call__
Jan 30 22:44:16 mov-orc-dev npx[17959]:     await super().__call__(scope, receive, send)
Jan 30 22:44:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/applications.py", line 107, in __call__
Jan 30 22:44:16 mov-orc-dev npx[17959]:     await self.middleware_stack(scope, receive, send)
Jan 30 22:44:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 186, in __call__
Jan 30 22:44:16 mov-orc-dev npx[17959]:     raise exc
Jan 30 22:44:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 164, in __call__
Jan 30 22:44:16 mov-orc-dev npx[17959]:     await self.app(scope, receive, _send)
Jan 30 22:44:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
Jan 30 22:44:16 mov-orc-dev npx[17959]:     await self.app(scope, receive, send)
Jan 30 22:44:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
Jan 30 22:44:16 mov-orc-dev npx[17959]:     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
Jan 30 22:44:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
Jan 30 22:44:16 mov-orc-dev npx[17959]:     raise exc
Jan 30 22:44:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
Jan 30 22:44:16 mov-orc-dev npx[17959]:     await app(scope, receive, sender)
Jan 30 22:44:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
Jan 30 22:44:16 mov-orc-dev npx[17959]:     await self.app(scope, receive, send)
Jan 30 22:44:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/routing.py", line 716, in __call__
Jan 30 22:44:16 mov-orc-dev npx[17959]:     await self.middleware_stack(scope, receive, send)
Jan 30 22:44:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/routing.py", line 736, in app
Jan 30 22:44:16 mov-orc-dev npx[17959]:     await route.handle(scope, receive, send)
Jan 30 22:44:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/routing.py", line 290, in handle
Jan 30 22:44:16 mov-orc-dev npx[17959]:     await self.app(scope, receive, send)
Jan 30 22:44:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/fastapi/routing.py", line 115, in app
Jan 30 22:44:16 mov-orc-dev npx[17959]:     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
Jan 30 22:44:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
Jan 30 22:44:16 mov-orc-dev npx[17959]:     raise exc
Jan 30 22:44:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
Jan 30 22:44:16 mov-orc-dev npx[17959]:     await app(scope, receive, sender)
Jan 30 22:44:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/fastapi/routing.py", line 101, in app
Jan 30 22:44:16 mov-orc-dev npx[17959]:     response = await f(request)
Jan 30 22:44:16 mov-orc-dev npx[17959]:                ^^^^^^^^^^^^^^^^
Jan 30 22:44:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/fastapi/routing.py", line 355, in app
Jan 30 22:44:16 mov-orc-dev npx[17959]:     raw_response = await run_endpoint_function(
Jan 30 22:44:16 mov-orc-dev npx[17959]:                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:44:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/fastapi/routing.py", line 243, in run_endpoint_function
Jan 30 22:44:16 mov-orc-dev npx[17959]:     return await dependant.call(**values)
Jan 30 22:44:16 mov-orc-dev npx[17959]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:44:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/server_python/main.py", line 530, in site_heartbeat
Jan 30 22:44:16 mov-orc-dev npx[17959]:     site = await storage.update_site_heartbeat(site_id)
Jan 30 22:44:16 mov-orc-dev npx[17959]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:44:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/server_python/storage.py", line 221, in update_site_heartbeat
Jan 30 22:44:16 mov-orc-dev npx[17959]:     row = await conn.fetchrow("SELECT * FROM sites WHERE LOWER(name) = LOWER($1)", site_id)
Jan 30 22:44:16 mov-orc-dev npx[17959]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:44:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/asyncpg/connection.py", line 752, in fetchrow
Jan 30 22:44:16 mov-orc-dev npx[17959]:     data = await self._execute(
Jan 30 22:44:16 mov-orc-dev npx[17959]:            ^^^^^^^^^^^^^^^^^^^^
Jan 30 22:44:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/asyncpg/connection.py", line 1873, in _execute
Jan 30 22:44:16 mov-orc-dev npx[17959]:     result, _ = await self.__execute(
Jan 30 22:44:16 mov-orc-dev npx[17959]:                 ^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:44:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/asyncpg/connection.py", line 1970, in __execute
Jan 30 22:44:16 mov-orc-dev npx[17959]:     result, stmt = await self._do_execute(
Jan 30 22:44:16 mov-orc-dev npx[17959]:                    ^^^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:44:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/asyncpg/connection.py", line 2013, in _do_execute
Jan 30 22:44:16 mov-orc-dev npx[17959]:     stmt = await self._get_statement(
Jan 30 22:44:16 mov-orc-dev npx[17959]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:44:16 mov-orc-dev npx[17959]:   File "/opt/color-routing-orchestrator/venv/lib/python3.12/site-packages/asyncpg/connection.py", line 443, in _get_statement
Jan 30 22:44:16 mov-orc-dev npx[17959]:     statement = await self._protocol.prepare(
Jan 30 22:44:16 mov-orc-dev npx[17959]:                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Jan 30 22:44:16 mov-orc-dev npx[17959]:   File "asyncpg/protocol/protocol.pyx", line 165, in prepare
Jan 30 22:44:16 mov-orc-dev npx[17959]: asyncpg.exceptions.UndefinedFunctionError: function lower(site) does not exist
Jan 30 22:44:16 mov-orc-dev npx[17959]: HINT:  No function matches the given name and argument types. You might need to add explicit type casts.